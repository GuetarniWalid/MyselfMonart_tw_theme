{%- comment -%} Check if filters should be shown for this collection type {%- endcomment -%}
{% assign show_filters = false %}
{%- if template.name == 'collection' -%}
  {% assign collection_type = collection.metafields.custom.type_of_collection | default: 'other' %}
  {% if collection_type == 'painting' and settings.enable_painting_filtering %}
    {% assign show_filters = true %}
  {% elsif collection_type == 'poster' and settings.enable_poster_filtering %}
    {% assign show_filters = true %}
  {% elsif collection_type == 'tapestry' and settings.enable_tapestry_filtering %}
    {% assign show_filters = true %}
  {% elsif collection_type == 'other' and settings.enable_other_filtering %}
    {% assign show_filters = true %}
  {% endif %}
{%- endif -%}

<sticky-header class="transition-colors duration-500 border-b border-solid border-main relative">
  <div>
    <div class="bg-secondary py-4 pl-6 pr-3 flex items-center justify-between border-b border-solid border-main min-h-[90px] md:pl-14 md:pr-10 mobile:relative">
      {% comment %} start on mobile {% endcomment %}
      <details class="inline-block h-full md:hidden">
        <summary class="group menu-opener list-none cursor-pointer">
          <span class="group-focus-visible:border-2 group-focus-visible:border-main rounded mobile-menu">
            <span class="hamburger" aria-hidden="false">{% render 'tw-icon-hamburger' %}</span>
            <span class="close hidden" aria-hidden="true">{% render 'tw-icon-close' %}</span>
          </span>
        </summary>
        <nav
          class="bg-secondary absolute bottom-0 left-0 w-screen border-t border-solid border-main close-nav transition-all duration-150 -z-10 h-[calc(100vh-90px)] overflow-y-auto scrollbar grid grid-rows-[1fr_auto]"
          role="dialog"
          aria-modal="true"
          aria-label="{{ "snippet.tw_sticky_header.navigation" | t }}">
          <ul class="px-5 gap-y-3 relative pb-8 {% if show_filters %}pt-[54px]{% else %}pt-8{% endif %}">
            {% for block in section.blocks %}
              {% if block.type == "collection_only" %}
                <li
                  class="obfuscate flex items-center gap-3 hover:bg-main-10 p-3 rounded-lg cursor-pointer"
                  data-url64="{{ block.settings.collection.url | base64_encode }}"
                  tabindex="0">
                  {% if block.settings.collection.featured_image != blank %}
                    {% assign image_alt = block.settings.collection.featured_image.alt | escape %}
                    {% if block.settings.collection.metafields.meta_object.media.value.alts.value[0] %}
                      {% assign image_alt = block.settings.collection.metafields.meta_object.media.value.alts.value[0] | escape %}
                    {% endif %}
                    {{ block.settings.collection.featured_image | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: image_alt, loading: 'lazy', class: 'rounded-md' }}
                  {% endif %}
                  {{ block.settings.collection.title | escape }}
                </li>
              {% elsif block.type == "product_only" %}
                <li
                  class="obfuscate flex items-center gap-3 hover:bg-main-10 p-3 rounded-lg cursor-pointer"
                  data-url64="{{ block.settings.product.url | base64_encode }}"
                  tabindex="0">
                  {% if block.settings.product.images[1] != blank %}
                    {% assign media_alt = block.settings.product.images[1].alt | escape %}
                    {% if block.settings.product.metafields.meta_object.media.value.alts.value[1] %}
                      {% assign media_alt = block.settings.product.metafields.meta_object.media.value.alts.value[1] | escape %}
                    {% endif %}
                    {{ block.settings.product.images[1] | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: media_alt, loading: 'lazy', class: 'rounded-md' }}
                  {% elsif block.settings.product.images[0] != blank %}
                    {% assign media_alt = block.settings.product.images[0].alt | escape %}
                    {% if block.settings.product.metafields.meta_object.media.value.alts.value[0] %}
                      {% assign media_alt = block.settings.product.metafields.meta_object.media.value.alts.value[0] | escape %}
                    {% endif %}
                    {{ block.settings.product.images[0] | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: media_alt, loading: 'lazy', class: 'rounded-md' }}
                  {% endif %}
                  {{ block.settings.product.title | escape }}
                </li>
              {% elsif block.type == "page_only" %}
                <li
                  class="obfuscate flex items-center gap-3 hover:bg-main-10 p-3 rounded-lg cursor-pointer"
                  data-url64="{{ block.settings.page.url | base64_encode }}"
                  tabindex="0">
                  {% if block.settings.image != blank %}
                    {% assign image_alt = block.settings.image.alt | escape %}
                    {% if block.settings.image.metafields.meta_object.media.value.alts.value[0] %}
                      {% assign image_alt = block.settings.image.metafields.meta_object.media.value.alts.value[0] | escape %}
                    {% endif %}
                    {{ block.settings.image | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: image_alt, loading: 'lazy', class: 'rounded-md' }}
                  {% endif %}
                  {{ block.settings.page.title | escape }}
                </li>
              {% elsif block.type == "parent_collection_images" %}
                <li class="details-wrapper group/one hover:bg-main-10 p-3 rounded-lg cursor-pointer">
                  <details class="js-nav-submenu">
                    <summary class="list-none flex items-center justify-between gap-3">
                      <div class="flex items-center gap-3">
                        {% if block.settings.product.images[1] != blank %}
                          {% assign image_alt = block.settings.product.images[1].alt | escape %}
                          {% if block.settings.product.metafields.meta_object.media.value.alts.value[1] %}
                            {% assign image_alt = block.settings.product.metafields.meta_object.media.value.alts.value[1] | escape %}
                          {% endif %}
                          {{ block.settings.product.images[1] | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: image_alt, loading: 'lazy', class: 'rounded-md' }}
                        {% endif %}
                        {{ block.settings.title | escape }}
                      </div>
                      {% render 'tw-icon-arrow'
                        , group_one: true %}
                    </summary>
                    <div class="absolute inset-0 bg-secondary pb-8 {% if show_filters %}pt-[54px]{% else %}pt-8{% endif %} px-5 transition-all duration-150 translate-x-full overflow-y-scroll overflow-x-hidden">
                      <h3
                        class="group bg-main-10 cursor-pointer py-2 px-4 rounded-md mb-2 text-xl"
                        tabindex="0"
                        role="button"
                        aria-label="{{ "sections.header.back" | t }}">
                        <span class="mr-2">{% render 'tw-icon-arrow', direction: "left", width: "40" %}</span>
                        {{ block.settings.title }}
                      </h3>
                      <ul class="gap-y-3 ">
                        {% for collection in block.settings.child_collection_list %}
                          <li
                            class="obfuscate flex items-center gap-3 hover:bg-main-10 p-3 rounded-lg cursor-pointer"
                            data-url64="{{ collection.url | base64_encode }}"
                            tabindex="0">
                            {% if collection.featured_image != blank %}
                              {% assign image_alt = collection.featured_image.alt | escape %}
                              {% if collection.metafields.meta_object.media.value.alts.value[0] %}
                                {% assign image_alt = collection.metafields.meta_object.media.value.alts.value[0] | escape %}
                              {% endif %}
                              {{ collection.featured_image | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: image_alt, loading: 'lazy', class: 'rounded-md' }}
                            {% endif %}
                            {{ collection.title | escape }}
                          </li>
                        {% endfor %}
                      </ul>
                    </div>
                  </details>
                </li>
              {% else %}
                <li class="details-wrapper group/one hover:bg-main-10 p-3 rounded-lg cursor-pointer">
                  <details class="js-nav-submenu">
                    <summary class="list-none flex items-center justify-between gap-3">
                      <div class="flex items-center gap-3">
                        {% if block.settings.product.images[1] != blank %}
                          {% assign image_alt = block.settings.product.images[1].alt | escape %}
                          {% if block.settings.product.metafields.meta_object.media.value.alts.value[1] %}
                            {% assign image_alt = block.settings.product.metafields.meta_object.media.value.alts.value[1] | escape %}
                          {% endif %}
                          {{ block.settings.product.images[1] | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: image_alt, loading: 'lazy', class: 'rounded-md' }}
                        {% endif %}
                        {{ block.settings.title | escape }}
                      </div>
                      {% render 'tw-icon-arrow'
                        , group_one: true %}
                    </summary>
                    <div class="absolute inset-0 bg-secondary pb-8 {% if show_filters %}pt-[54px]{% else %}pt-8{% endif %} px-5 transition-all duration-150 translate-x-full overflow-y-scroll overflow-x-hidden">
                      <h3
                        class="group bg-main-10 cursor-pointer py-2 px-4 rounded-md mb-2 text-xl"
                        tabindex="0"
                        role="button"
                        aria-label="{{ "sections.header.back" | t }}">
                        <span class="mr-2">{% render 'tw-icon-arrow', direction: "left", width: "40" %}</span>
                        {{ block.settings.title | escape }}
                      </h3>
                      <ul class="gap-y-3">
                        {% liquid
                          assign sections_count = 0
                          if block.settings.child_collection_list_1_section != blank
                            assign sections_count = sections_count | plus: 1
                          endif
                          if block.settings.child_collection_list_2_section != blank
                            assign sections_count = sections_count | plus: 1
                          endif
                          if block.settings.child_collection_list_3_section != blank
                            assign sections_count = sections_count | plus: 1
                          endif
                          if block.settings.child_collection_list_4_section != blank
                            assign sections_count = sections_count | plus: 1
                          endif
                        %}
                        {% for id in (1..sections_count) %}
                          {% liquid
                            assign collection_id = "child_collection_list_" | append: id | append: '_section'
                            assign collection_list = block.settings[collection_id]
                            assign title_id = "title_" | append: id | append: '_section'
                          %}
                          <li class="details-wrapper group/one hover:bg-main-10 p-3 rounded-lg cursor-pointer">
                            <details class="js-nav-submenu">
                              <summary class="list-none flex items-center justify-between gap-3">
                                <div class="flex items-center gap-3">
                                  {% if block.settings.product.images[1] != blank %}
                                    {% assign image_alt = block.settings.product.images[1].alt | escape %}
                                    {% if block.settings.product.metafields.meta_object.media.value.alts.value[1] %}
                                      {% assign image_alt = block.settings.product.metafields.meta_object.media.value.alts.value[1] | escape %}
                                    {% endif %}
                                    {{ block.settings.product.images[1] | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: image_alt, loading: 'lazy', class: 'rounded-md' }}
                                  {% endif %}
                                  {{ block.settings[title_id] | escape }}
                                </div>
                                {% render 'tw-icon-arrow'
                                  , group_one: true %}
                              </summary>
                              <div class="absolute inset-0 bg-secondary pb-8 {% if show_filters %}pt-[54px]{% else %}pt-8{% endif %} px-5 transition-all duration-150 translate-x-full overflow-y-scroll overflow-x-hidden">
                                <h3
                                  class="group bg-main-10 cursor-pointer py-2 px-4 rounded-md mb-2 text-xl"
                                  tabindex="0"
                                  role="button"
                                  aria-label="{{ "sections.header.back" | t }}">
                                  <span class="mr-2">{% render 'tw-icon-arrow', direction: "left", width: "40" %}</span>
                                  {{ block.settings[title_id] | escape }}
                                </h3>
                                <ul class="gap-y-3">
                                  {% for collection in block.settings[collection_id] %}
                                    <li
                                      class="obfuscate flex items-center gap-3 hover:bg-main-10 p-3 rounded-lg cursor-pointer"
                                      data-url64="{{ collection.url | base64_encode }}"
                                      tabindex="0">
                                      {% if collection.featured_image != blank %}
                                        {% assign image_alt = collection.featured_image.alt | escape %}
                                        {% if collection.metafields.meta_object.media.value.alts.value[0] %}
                                          {% assign image_alt = collection.metafields.meta_object.media.value.alts.value[0] | escape %}
                                        {% endif %}
                                        {{ collection.featured_image | image_url: width: 45, height: 45 | image_tag: width: 45, height: 45, alt: image_alt, loading: 'lazy', class: 'rounded-md' }}
                                      {% endif %}
                                      {{ collection.title | escape }}
                                    </li>
                                  {% endfor %}
                                </ul>
                              </div>
                            </details>
                          </li>
                        {% endfor %}
                      </ul>
                    </div>
                  </details>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
          <div class="flex justify-between pb-16 pt-6 bg-main text-secondary">
            {% render 'tw-list-social' %}
            <details class="relative px-6">
              <summary class="flex items-center justify-center text-secondary cursor-pointer">
                {% if localization.country.currency.iso_code == 'CAD' and localization.language.iso_code == 'en' %}
                  {% render 'icon-flag-ca' %}
                {% elsif localization.country.currency.iso_code == 'CHF' and localization.language.iso_code == 'fr' %}
                  {% render 'icon-flag-ch' %}
                {% elsif localization.country.currency.iso_code == 'DKK' and localization.language.iso_code == 'en' %}
                  {% render 'icon-flag-dk' %}
                {% elsif localization.country.currency.iso_code == 'EUR' and localization.language.iso_code == 'fr' %}
                  {% render 'icon-flag-fr' %}
                {% elsif localization.country.currency.iso_code == 'GBP' and localization.language.iso_code == 'en' %}
                  {% render 'icon-flag-uk' %}
                {% elsif localization.country.currency.iso_code == 'USD' and localization.language.iso_code == 'en' %}
                  {% render 'icon-flag-us' %}
                {% else %}
                  {% render 'icon-flag-world' %}
                {% endif %}
              </summary>
              <ul class="absolute right-6 top-0 -translate-y-full z-50 bg-white rounded shadow-lg pt-1">
                {% liquid
                  if template.name == 'product'
                    assign resource = product
                  elsif template.name == 'collection'
                    assign resource = collection
                  elsif template.name == 'page'
                    assign resource = page
                  else
                    assign resource = nil
                  endif
                %}
                {%- for language in localization.available_languages -%}
                  {%- for currency in shop.enabled_currencies -%}
                    {% if currency.iso_code == 'CAD' and language.iso_code == 'en' %}
                      <li tabindex="-1">
                        <localization-flag>
                          <a
                            class="inline-flex items-center hover:bg-main-10 w-full py-2 mb-1 px-3 whitespace-nowrap text-main{% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'CAD' %} bg-main-10 cursor-not-allowed{% endif %}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'CAD' %}
                              role="link"
                              aria-disabled="true"
                            {% else %}
                              {% liquid
                                if template.name == 'index'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en'
                                elsif template.name == 'search'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/search'
                                elsif template.name == 'cart'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/cart'
                                else
                                  assign url = resource.metafields.translation.handle.value[language.iso_code]
                                endif
                              %}
                              href="{{ url }}?currency={{ currency.iso_code }}"
                            {% endif %}
                            hreflang="{{ language.iso_code }}"
                            lang="{{ language.iso_code }}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'CAD' %}
                              aria-current="true"
                            {% endif %}
                            data-value="{{ language.iso_code }}">
                            {% render 'icon-flag-ca' %}&nbsp;Canada
                          </a>
                        </localization-flag>
                      </li>
                    {% elsif currency.iso_code == 'CHF' and language.iso_code == 'fr' %}
                      <li tabindex="-1">
                        <localization-flag>
                          <a
                            class="inline-flex items-center hover:bg-main-10 w-full py-2 mb-1 px-3 whitespace-nowrap text-main{% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'CHF' %} bg-main-10 cursor-not-allowed{% endif %}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'CHF' %}
                            role="link"
                            aria-disabled="true"
                            {% else %}
                              {% liquid
                                if template.name == 'index'
                                  assign url = routes.root_url | remove_last: 'en'
                                elsif template.name == 'search'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'search'
                                elsif template.name == 'cart'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'cart'
                                else
                                  assign url = resource.metafields.translation.handle.value[language.iso_code]
                                endif
                              %}
                              href="{{ url }}?currency={{ currency.iso_code }}"
                            {% endif %}
                            hreflang="{{ language.iso_code }}"
                            lang="{{ language.iso_code }}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'CHF' %}
                            aria-current="true"
                            {% endif %}
                            data-value="{{ language.iso_code }}">
                            {% render 'icon-flag-ch' %}&nbsp;&nbsp;Suisse
                          </a>
                        </localization-flag>
                      </li>
                    {% elsif currency.iso_code == 'DKK' and language.iso_code == 'en' %}
                      <li tabindex="-1">
                        <localization-flag>
                          <a
                            class="inline-flex items-center hover:bg-main-10 w-full py-2 mb-1 px-3 whitespace-nowrap text-main{% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'DDK' %} bg-main-10 cursor-not-allowed{% endif %}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'DDK' %}
                            role="link"
                            aria-disabled="true"
                            {% else %}
                            {% liquid
                                if template.name == 'index'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en'
                                elsif template.name == 'search'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/search'
                                elsif template.name == 'cart'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/cart'
                                else
                                  assign url = resource.metafields.translation.handle.value[language.iso_code]
                                endif
                              %}
                              href="{{ url }}?currency={{ currency.iso_code }}"
                            {% endif %}
                            hreflang="{{ language.iso_code }}"
                            lang="{{ language.iso_code }}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'DDK' %}
                            aria-current="true"
                            {% endif %}
                            data-value="{{ language.iso_code }}">
                            {% render 'icon-flag-dk' %}&nbsp;&nbsp;Danmark
                          </a>
                        </localization-flag>
                      </li>
                    {% elsif currency.iso_code == 'EUR' and language.iso_code == 'fr' %}
                      <li tabindex="-1">
                        <localization-flag>
                          <a
                            class="inline-flex items-center hover:bg-main-10 w-full py-2 mb-1 px-3 whitespace-nowrap text-main{% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'EUR' %} bg-main-10 cursor-not-allowed{% endif %}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'EUR' %}
                            role="link"
                            aria-disabled="true"
                            {% else %}
                            {% liquid
                                if template.name == 'index'
                                  assign url = routes.root_url | remove_last: 'en'
                                elsif template.name == 'search'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'search'
                                elsif template.name == 'cart'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'cart'
                                else
                                  assign url = resource.metafields.translation.handle.value[language.iso_code]
                                endif
                              %}
                              href="{{ url }}?currency={{ currency.iso_code }}"
                            {% endif %}
                            hreflang="{{ language.iso_code }}"
                            lang="{{ language.iso_code }}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'EUR' %}
                            aria-current="true"
                            {% endif %}
                            data-value="{{ language.iso_code }}">
                            {% render 'icon-flag-fr' %}&nbsp;&nbsp;France
                          </a>
                        </localization-flag>
                      </li>
                    {% elsif currency.iso_code == 'GBP' and language.iso_code == 'en' %}
                      <li tabindex="-1">
                        <localization-flag>
                          <a
                            class="inline-flex items-center hover:bg-main-10 w-full py-2 mb-1 px-3 whitespace-nowrap text-main{% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'GBP' %} bg-main-10 cursor-not-allowed{% endif %}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'GBP' %}
                            role="link"
                            aria-disabled="true"
                            {% else %}
                            {% liquid
                                if template.name == 'index'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en'
                                elsif template.name == 'search'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/search'
                                elsif template.name == 'cart'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/cart'
                                else
                                  assign url = resource.metafields.translation.handle.value[language.iso_code]
                                endif
                              %}
                              href="{{ url }}?currency={{ currency.iso_code }}"
                            {% endif %}
                            hreflang="{{ language.iso_code }}"
                            lang="{{ language.iso_code }}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'GBP' %}
                            aria-current="true"
                            {% endif %}
                            data-value="{{ language.iso_code }}">
                            {% render 'icon-flag-uk' %}&nbsp;&nbsp;UK
                          </a>
                        </localization-flag>
                      </li>
                    {% elsif currency.iso_code == 'USD' and language.iso_code == 'en' %}
                      <li tabindex="-1">
                        <localization-flag>
                          <a
                            class="inline-flex items-center last-focusable hover:bg-main-10 w-full py-2 mb-1 px-3 whitespace-nowrap text-main{% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'USD' %} bg-main-10 cursor-not-allowed{% endif %}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'USD' %}
                              role="link"
                              aria-disabled="true"
                            {% else %}
                              {% liquid
                                if template.name == 'index'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en'
                                elsif template.name == 'search'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/search'
                                elsif template.name == 'cart'
                                  assign url = routes.root_url | remove_last: 'en' | append: 'en' | append: '/cart'
                                else
                                  assign url = resource.metafields.translation.handle.value[language.iso_code]
                                endif
                              %}
                              href="{{ url }}?currency={{ currency.iso_code }}"
                            {% endif %}
                            hreflang="{{ language.iso_code }}"
                            lang="{{ language.iso_code }}"
                            {% if language.iso_code == localization.language.iso_code and localization.country.currency.iso_code == 'USD' %}
                              aria-current="true"
                            {% endif %}
                            data-value="{{ language.iso_code }}">
                            {% render 'icon-flag-us' %}&nbsp;&nbsp;USA
                          </a>
                        </localization-flag>
                      </li>
                    {% endif %}
                  {%- endfor -%}
                {%- endfor -%}
              </ul>
            </details>
          </div>
        </nav>
      </details>
      {% comment %} end on mobile {% endcomment %}
      <h2 class="cursor-pointer inline-flex items-center obfuscate text-2xl sm:text-3xl mobile:absolute mobile:left-1/2 mobile:-translate-x-1/2 mobile:top-1/2 mobile:-translate-y-1/2" data-url64="{{ routes.root_url | base64_encode }}">
        {% if section.settings.logo_svg != blank %}
          {{ section.settings.logo_svg }}
        {% else %}
          {% render 'tw-default-logo' %}
        {% endif %}
        <span class="ml-3 hidden xs:inline">MyselfMonArt</span>
      </h2>

      {% render 'tw-loup-like-button' %}
    </div>
    {% comment %} start on desktop {% endcomment %}
    <nav
      class="hidden md:block bg-secondary border-b border-solid border-main px-10"
      role="dialog"
      aria-modal="true"
      aria-label="{{ "snippet.tw_sticky_header.navigation" | t }}">
      <ul
        id="desktop-upper-nav"
        class="flex justify-center items-center gap-4 2xl:gap-9"
        role="menu">
        {% for block in section.blocks %}
          {% if block.type == "collection_only" %}
            <li
              class="obfuscate cursor-pointer p-3 outline-none hover:bg-main-10 focus:bg-main-10"
              data-url64="{{ block.settings.collection.url | base64_encode }}"
              tabindex="0">
              {{ block.settings.collection.title | escape }}
            </li>
          {% elsif block.type == "product_only" %}
            <li
              class="obfuscate cursor-pointer p-3 outline-none hover:bg-main-10 focus:bg-main-10"
              data-url64="{{ block.settings.product.url | base64_encode }}"
              tabindex="0">
              {{ block.settings.product.title | escape }}
            </li>
          {% elsif block.type == "page_only" %}
            <li
              class="obfuscate cursor-pointer p-3 outline-none hover:bg-main-10 focus:bg-main-10"
              data-url64="{{ block.settings.page.url | base64_encode }}"
              tabindex="0">
              {{ block.settings.page.title | escape }}
            </li>
          {% elsif block.type == "parent_collection_images" %}
            {% liquid
              assign id = forloop.index
              assign li_count = section.blocks | size
              assign transform_shift = forloop.index | times: 100 | divided_by: li_count
              if transform_shift > 50
                assign left_shift = '100%'
              else
                assign left_shift = '0'
                assign transform_shift = transform_shift | divided_by: 2
              endif
            %}
            <li
              class="group relative cursor-pointer p-3 outline-none hover:bg-main-10 focus:bg-main-10"
              tabindex="0"
              aria-haspopup="true"
              aria-expanded="false">
              <span
                {% if block.settings.link != blank %}
                class="obfuscate before:absolute before:inset-0"
                data-url64="{{ block.settings.link | base64_encode }}"
                tabindex="0"
                {% endif %}>
                {{ block.settings.title | escape }}
              </span>
              <ul
                class="hidden group-hover:grid absolute -bottom-[1px] bg-secondary p-3 gap-3 min-w-max cursor-default rounded-b"
                style="transform:translate(-{{ transform_shift }}%,100%);left:{{ left_shift }};grid-template-columns:var(--desktop-nav-cols-{{ id }});grid-template-rows:var(--desktop-nav-rows-{{ id }});"
                role="menu">
                {% for collection in block.settings.child_collection_list %}
                  {% liquid
                    if forloop.length < 2
                      assign img_width = 200
                      assign img_height = 300
                      assign desktop_nav_cols = "auto"
                      assign desktop_nav_rows = "auto"
                    elsif forloop.length < 5
                      assign img_width = 200
                      assign img_height = 300
                      assign desktop_nav_cols = "auto auto"
                      assign desktop_nav_rows = "auto auto"
                    elsif forloop.length < 7
                      assign img_width = 200
                      assign img_height = 300
                      assign desktop_nav_cols = "auto auto auto"
                      assign desktop_nav_rows = "auto auto"
                    else
                      assign img_width = 150
                      assign img_height = 225
                      assign desktop_nav_cols = "auto auto auto"
                      assign desktop_nav_rows = "auto auto auto"
                    endif
                  %}
                  <style > :root
                    {
                      --desktop-nav-cols-{{ id }}: {{ desktop_nav_cols }};
                      --desktop-nav-rows-{{ id }}: {{ desktop_nav_rows }};
                    }
                  </style>
                  <li
                    class="group/link relative obfuscate cursor-pointer before:absolute before:bottom-0 before:w-full before:h-1/2 before:z-10 before:bg-gradient-to-t before:from-black/80 before:to-transparent rounded overflow-hidden outline-none{% if forloop.first %} first-elem{% endif %}{% if forloop.last %} last-elem{% endif %}"
                    data-url64="{{ collection.url | base64_encode }}"
                    tabindex="-1">
                    {% if collection.featured_image != blank %}
                      {% assign image_alt = collection.featured_image.alt | escape %}
                      {% if collection.metafields.meta_object.media.value.alts.value[0] %}
                        {% assign image_alt = collection.metafields.meta_object.media.value.alts.value[0] | escape %}
                      {% endif %}
                      {{ collection.featured_image | image_url: width: img_width, height: img_height | image_tag: width: img_width, height: img_height, alt: image_alt, loading: 'lazy', class: 'max-w-none transition-all duration-300 ease-out group-hover/link:scale-110 group-focus/link:scale-110' }}
                    {% endif %}
                    <p class="absolute z-20 bottom-4 text-xl text-secondary text-center w-full">
                      {{ collection.title | escape }}
                    </p>
                  </li>
                {% endfor %}
              </ul>
            </li>
          {% else %}
            {% liquid
              assign id = forloop.index
              assign li_count = section.blocks | size
              assign transform_shift = forloop.index | times: 100 | divided_by: li_count
              if transform_shift > 50
                assign left_shift = '100%'
              else
                assign left_shift = '0'
                assign transform_shift = transform_shift | divided_by: 2
              endif
            %}
            <li
              class="group relative cursor-pointer p-3 outline-none hover:bg-main-10 focus:bg-main-10"
              tabindex="0"
              aria-haspopup="true"
              aria-expanded="false">
              <span
                {% if block.settings.link != blank %}
                class="obfuscate before:absolute before:inset-0"
                data-url64="{{ block.settings.link | base64_encode }}"
                tabindex="0"
                {% endif %}>
                {{ block.settings.title | escape }}
              </span>
              <ul
                class="hidden group-hover:grid grid-cols-[auto_auto_auto] grid-rows-[auto_auto_auto] absolute translate-y-full -bottom-[1px] bg-secondary p-3 gap-x-5 gap-y-3 min-w-max cursor-default rounded-b"
                style="transform:translate(-{{ transform_shift }}%,100%);left:{{ left_shift }};"
                role="menu">
                {% liquid
                  assign sections_count = 0
                  if block.settings.child_collection_list_1_section != blank
                    assign sections_count = sections_count | plus: 1
                  endif
                  if block.settings.child_collection_list_2_section != blank
                    assign sections_count = sections_count | plus: 1
                  endif
                  if block.settings.child_collection_list_3_section != blank
                    assign sections_count = sections_count | plus: 1
                  endif
                  if block.settings.child_collection_list_4_section != blank
                    assign sections_count = sections_count | plus: 1
                  endif
                %}
                {% for id in (1..sections_count) %}
                  {% liquid
                    assign collection_id = "child_collection_list_" | append: id | append: '_section'
                    assign collection_list = block.settings[collection_id]
                    assign title_id = "title_" | append: id | append: '_section'
                  %}
                  <li class="no-focusable">
                    <span class="block bg-main-10 py-2 px-4 font-heading rounded-lg mb-3">{{ block.settings[title_id] }}</span>
                    <ul class="pl-2" tabindex="-1">
                      {% for collection in collection_list %}
                        <li
                          class="obfuscate cursor-pointer py-1 px-2 rounded-md hover:bg-main-10 focus:bg-main-10 outline-none {% if forloop.first and forloop.parentloop.first %} first-elem{% endif %}{% if forloop.last and forloop.parentloop.last %} last-elem{% endif %}"
                          data-url64="{{ collection.url | base64_encode }}"
                          tabindex="-1">
                          {{ collection.title | escape }}
                        </li>
                      {% endfor %}
                    </ul>
                  </li>
                {% endfor %}
              </ul>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </nav>
    {% comment %} end on desktop {% endcomment %}
  </div>

  {%- comment -%} Mobile filter button - Collection pages only {%- endcomment -%}
  {%- if show_filters -%}
    <div
      id="mobile-filter-button-wrapper"
      class="md:hidden w-screen bg-secondary border-b border-main transition-transform duration-150"
      style="margin-left: calc(-50vw + 50%);">

      <button
        type="button"
        id="filter-button-mobile"
        class="w-full flex items-center justify-center gap-3 py-3 px-4 hover:bg-main-10 transition-colors duration-100"
        aria-label="{{ 'sections.filter_drawer.open' | t }}"
        aria-expanded="false">

        {% render 'icon-filter' %}

        <span class="font-semibold text-sm heading">
          {{ 'sections.filter_drawer.button_label' | t | upcase }}
        </span>

        {% if collection.products_count %}
          <span class="text-xs text-main-70">
            {{ collection.products_count }} {{ 'sections.filter_drawer.products' | t }}
          </span>
        {% endif %}
      </button>
    </div>
  {%- endif -%}

</sticky-header>