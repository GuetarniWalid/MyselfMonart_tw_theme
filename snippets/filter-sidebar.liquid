{% comment %}
  Desktop filter sidebar
  Renders on md+ breakpoints alongside product grid

  Usage:
  {% render 'filter-sidebar' %}
{% endcomment %}

{%- comment -%} Dynamically render all filters from Search & Discovery {%- endcomment -%}
<aside
  class="hidden md:block w-64 pr-8"
  aria-label="{{ 'sections.filter_drawer.title' | t }}">

  <div class="sticky top-4">

    <div class="border-1 border-main rounded-xl bg-secondary max-h-[65vh] overflow-y-auto scrollbar-hidden">
      {%- comment -%} Filter header - NOT sticky, scrolls away {%- endcomment -%}
      <div class="p-5 bg-accent-20 flex justify-between items-center">
        <h2 class="font-bold text-sm heading">{{ 'sections.filter_drawer.filter_label' | t }}</h2>
        <button
          type="button"
          class="clear-filters hidden text-sm text-main-80 hover:underline hover:text-main transition-colors"
          aria-label="{{ 'sections.filter_drawer.clear_all' | t }}">
          {{ 'sections.filter_drawer.clear_all' | t }}
        </button>
      </div>

      {%- comment -%} Loop through all filters and render them dynamically {%- endcomment -%}
      {% for filter in collection.filters %}
        {% if filter.type == 'list' %}
          {%- comment -%} Check if this is a color filter to add visual swatches {%- endcomment -%}
          {% assign is_color_filter = false %}
          {% assign filter_label_lower = filter.label | downcase %}
          {% if filter.param_name contains 'color' or filter_label_lower contains 'color' or filter_label_lower contains 'colour' or filter_label_lower contains 'couleur' %}
            {% assign is_color_filter = true %}
          {% endif %}

          {% if is_color_filter %}
            {% render 'filter-colors-section', id_prefix: 'filter-' | append: forloop.index | append: '-', color_filter: filter, filter_index: forloop.index %}
          {% else %}
            {% render 'filter-generic-section', id_prefix: 'filter-' | append: forloop.index | append: '-', filter: filter, filter_index: forloop.index %}
          {% endif %}
        {% endif %}
      {% endfor %}

      {%- comment -%} Collection navigation section (not a filter) {%- endcomment -%}
      {% render 'collection-navigation-section', current_collection: collection %}
    </div>
  </div>
</aside>
