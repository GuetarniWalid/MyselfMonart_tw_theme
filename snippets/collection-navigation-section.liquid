{% comment %}
  Collection navigation section
  Displays other collections with the same type_of_collection metafield

  Parameters:
  - current_collection: The current collection object

  Usage:
  {% render 'collection-navigation-section', current_collection: collection %}
{% endcomment %}

{% if current_collection %}
  {%- comment -%} Get the current collection's type {%- endcomment -%}
  {% assign current_type = current_collection.metafields.custom.type_of_collection %}

  {% if current_type %}
    {%- comment -%} Manually find all collections with the same type {%- endcomment -%}
    {% assign related_count = 0 %}

    {%- comment -%} First pass: count related collections {%- endcomment -%}
    {% for col in collections %}
      {% if col.metafields.custom.type_of_collection == current_type and col.handle != current_collection.handle %}
        {% assign related_count = related_count | plus: 1 %}
      {% endif %}
    {% endfor %}

    {%- comment -%} Only show section if there are other collections {%- endcomment -%}
    {% if related_count > 0 %}
      <div class="py-4 border-t border-main">
        <details class="group/details">
          <summary class="sticky top-0 z-5 bg-secondary flex justify-between items-center cursor-pointer list-none select-none py-2 px-4">
            <span class="font-semibold text-sm font-heading">{{ 'sections.filter_drawer.other_collections_label' | t }}</span>
            <span class="group-open/details:rotate-180 transition-transform duration-200">
              {% render 'tw-icon-caret', width: "12" %}
            </span>
          </summary>

          <ul class="pt-3 pb-4 px-4 flex flex-col gap-2 list-none">
            {% for col in collections %}
              {% if col.metafields.custom.type_of_collection == current_type and col.handle != current_collection.handle %}
                <li class="group flex items-center gap-2">
                  <a
                    href="{{ col.url }}"
                    class="text-sm text-main-80 hover:text-main hover:underline transition-colors py-1 flex items-center gap-1">
                    <span class="truncate">{{ col.title }}</span>
                    <span class="flex-shrink-0">{% render 'tw-icon-arrow' %}</span>
                  </a>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        </details>
      </div>
    {% endif %}
  {% endif %}
{% endif %}
